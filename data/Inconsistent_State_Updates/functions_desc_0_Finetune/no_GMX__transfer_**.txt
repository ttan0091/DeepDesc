Type of vulnerability: Reentrancy Attack
Cause of vulnerability: Incorrect placement of the inPrivateTransferMode check, which allows an unauthenticated flash loan contract to bypass the control and borrow the missing amount from the private reserve, significantly draining the leveraged and staking modes reserves.
Working of the vulnerability: An attacker can leverage the incorrect inPrivateTransferMode check to repeatedly lend PegUsd, thereby draining all the reserves above the reserves ratio set by governance, leading to minting of base tokens for the possibly empty borrow backstop.
Potential exploits: A flash loan contract can repeatedly flash loan PegUsd, draining all reserves, and borrowing significant leveraged funds or reserving most of the staking return, resulting in significant minting of base tokens for potentially empty borrow backstop or significant portion of the nonrebasing circulating supply being transferred to staking pools.