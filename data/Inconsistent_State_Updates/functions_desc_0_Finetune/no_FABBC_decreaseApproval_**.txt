Type of vulnerability: Denial of Service (DoS) for Zero Allowance
Cause of vulnerability: Inability of token contract to handle zero allowance when using fully delegated approvals (FDC) with Zimrii Reviewers and staking. The allowance must be zero bytes shorter (at least 192 bits for ID and 64 bits for status)
Working process of the code: The function decreaseApproval in the approvalFightEnabledToken initially checks if the allowance is zero. If it is, the function raises an allowance change event without updating the allowance, causing a mismatch between the event log and the actual balance review contract state. This discrepancy triggers an exception, forcing the status to change and fatally rejecting the approval, leading to the DoS for FDC.