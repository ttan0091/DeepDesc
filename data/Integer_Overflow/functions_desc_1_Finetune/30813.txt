Type of vulnerability: Reentrancy or Logic Error
Cause of vulnerability: Logic Error
Details of the vulnerability: The `party()` function incorrectly uses the `value` variable as the transfer amount to the sender, which is pegged to a pool. However, this `value` is not absolute and is subject to conditions surrounding collateral value, price oracle values, and slippage rates, leading to under or over valuation of transfer amounts.
Impact of the vulnerability: The vulnerability allows the attacker to use an alternative token in excess of the required amount when calling the `addTokens()` function. The attacker can then call the `party()` function to withdraw funds back, bypassing the intended pegging and value lock of tokens.
Recommended fix: Ensure that the `party()` function transfers an amount of pegged tokens based on the locked value of the user, rather than the direct value of alternative tokens they provided.