Type of vulnerability: Logical Error in Validation
Cause of vulnerability: The contract allows users to redeem tokens by specifying a future timestamp (`sigExp`) with no additional check beyond ensuring that the current block's timestamp is less than `sigExp`.
Explanation of the vulnerability: An attacker can front-run a legitimate redemption transaction by submitting their own transaction with a higher `karma` value before the legitimate transaction is included in a block. This allows the attacker to manipulate the totalSupply in their favor, preventing the legitimate redemption from fully executing.
Impact of the vulnerability: The totalSupply can be inflated by attackers, causing financial loss to legitimate users and distorting the token economy by introducing excessive supply.
Patch for the vulnerability: Implement a check to ensure that the `sigExp` value in the transaction does not exceed a predetermined maximum time interval (e.g., 1 week) from the block timestamp. Additionally, update the `totalSupply` increment to occur before any validation checks to ensure that the increments are included in the blockchain regardless of the subsequent control flow.