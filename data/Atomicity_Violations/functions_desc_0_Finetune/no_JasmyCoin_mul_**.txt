Type of vulnerability: Integer Overflow/Underflow
Cause of vulnerability: Lack of proper input validation in the mul() function of the SafeMath library, used in the SafeMathUpgradeable library, specifically in the SafeMathUpgradeableLib in OpenZeppelin 4.0.0.
Working process of the code: When the SafeMathUpgradeable library is used, particularly the mul() operation, it does not provide input validation to ensure that b is not zero. This allows an attacker to pass b = 0 to the PoolOpLib contract, bypassing the input validation checks and causing the function to return 0 tokens, which can lead to funds being stuck in the contract.