Type of vulnerability: Denial of Service (DoS)
Cause of vulnerability: Infinite loop when iterating over the increaseonly set
Description of vulnerability: The design of the increaseonly set allows an attacker to add the same value multiple times, causing the length, get, and indexOf functions to enter an infinite loop when trying to iterate over such a set.
Explanation of the vulnerable function: The length function is an internal view function that is used to determine the length of the set. It calls the _length function of the underlying AVLTree library, which attempts to traverse the tree nodes to count the elements. However, due to the increaseonly property of the set, multiple instances of the same value can be added, leading to an infinite loop during traversal. This allows an attacker to mint wPeg repeatedly with the same token amount, causing the loop to consume all gas and render the contract unusable.