Type of vulnerability: Integer Overflow
Cause of vulnerability: Lack of sufficient overflow checks in the batch transfer function, specifically when updating the total supply during selftransfers.
Working process of the code: The function iterates over the recipient addresses and values provided in the recipients and values arrays, respectively. For each iteration, it checks if the to address is not zero, validates the value, updates the balance of the recipient, and emits a Transfer event. After processing all transfers, it updates the balance of the sender by subtracting the total transferred value. This final balance update lacks proper overflow checks, potentially leading to an erroneous state where the total supply is greater than the maximum token value allowed by the type uint256.
Necessary modifications: Add an overflow check for the totalValue in the final balance update, ensuring that the total transferred value does not exceed the maximum token value.