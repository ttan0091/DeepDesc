Type of vulnerability: Logic Error
Cause of vulnerability: The `updateAd` function uses the block timestamp to set the `purchaseTimestamp`, allowing the value of `purchaseTimestamp` to be backdated.
Working of the vulnerability: An attacker can call the `updateAd` function multiple times to backdate the `purchaseTimestamp`, causing the `getVolumeInInterval` function to calculate ad rewrads for multiple intervals simultaneously, leading to unjustified rewards.
Proof of Concept (PoC): Deploy the contract and initialize the deployment with an ad length of 20 minutes. Call the `updateAd` function multiple times within the 20 minutes to manipulate the `purchaseTimestamp`. Then, call the `getVolumeInInterval` function to show that rewards are unjustifiably calculated for multiple intervals.