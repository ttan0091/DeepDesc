Type of contract: Vulnerable Contract
Vulnerability: Incorrect Assumption on Callee Address
Cause of vulnerability: The contract assumes that the data passed to the delegatecall function includes a 32byte prefix representing the address of the function to be called. However, this assumption is incorrect, leading to the delegatecall using the wrong address and potentially causing unintended actions.
Impact of vulnerability: The incorrect address usage in delegatecall can cause the contract to interact with unintended functions or storage slots, leading to unauthorized operations or unexpected behavior.
Corrective action: The contract should be modified to correctly handle the address extraction from the data and ensure that it is used as the calldata for the delegatecall. Specifically, the requireStackDepth function needs to parse the data correctly to extract the delegate address and calldata, as well as define a proper interface for invoking this function.