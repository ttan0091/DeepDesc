Type of vulnerability: WriteCheckpointFunctionVotingPowerManipulation
Cause of vulnerability: The writeCheckpoint function in the DeltaVotingCheckpoint and PowerDecreaseHVWCheckpoint contracts allows for the addition of excesses and support in the case of a contract designed for scheduled increases or recurring votes, which affects the voting power calculation.
Explanation of working process: When the writeCheckpoint function is called with the mode set to subtract and the remaining (from checks effects interactions) value less than the checkpoint.totalVotes value, the function sets checkpoint.totalVotes to remaining and stores a new checkpoint with the remaining voting power, allowing for a refund. This behavior is exploited in the modifyProposalsVotingPower function to manipulate the oldCheckpoint value for future checkpoint calculations.