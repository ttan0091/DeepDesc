Type of vulnerability: Access Control Check Bypass
Cause of vulnerability: The setVault function does not update the delayVault to the current time when called by the Vault, allowing an attacker to delay the valid Vault transaction indefinitely.
Working process of the vulnerability: An attacker can call the setVault function multiple times, each time setting a new pendingVault and delayVault. If the delayVault condition is not yet true, the attacker can block the Vault from taking over by repeating this process. This results in a DoS attack, preventing normal operation of the Vault.
Recommended solution: Update the delayVault to the current time each time the setVault function is called. This ensures that if a new pendingVault is set, it can take over in a timely manner. Additionally, limit the number of times the setVault function can be called by introducing a maxCallsToSetVault parameter.