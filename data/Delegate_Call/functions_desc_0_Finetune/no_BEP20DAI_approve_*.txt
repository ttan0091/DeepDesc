Type of vulnerability: Front running / Sandwich attack (MEV)
Cause of vulnerability: Lack of slippage in early swaps and no direct tokenretrieval mechanism
Working process: An attacker monitors the mempool for transactions increasing the token amount or moving token amount to another address before the swap. The attacker then inserts a new transaction with a higher gas price to front run the original transaction. The attacker's transaction simulates the swap with a higher token amount and a full peg amount. After the block is mined, the original transaction executes, resulting in the victim receiving fewer tokens and the attacker receiving the excess tokens transferred back.