Type of vulnerability: Reentry attack or multiple rewards claim
Cause of vulnerability: The reward flag of the first earner is shared with subsequent earners during claimReward() and reward() are called consecutively.
Details of how the vulnerability is exploited: The vulnerability is exploited by the multiple rewards claim functionality that allows an attacker to call the reward() or claimReward() functions multiple times in a row, sharing the reward flag of the first earner with subsequent earners, leading to double counting of rewards.
Impacted versions: The vulnerability exists in versions 0.6.4 through 0.1.6.3
Fix for the vulnerability: The vulnerability can be fixed by including the reward flag resetting functionality from version 0.1.6.4, which ensures that the reward flag is set to 0 for all users except the first earner. This prevents the reward flag from being shared and eliminates the possibility of double counting of rewards.
Reference: https://github.com/GravityFinance/gravitycore/pull/34/files