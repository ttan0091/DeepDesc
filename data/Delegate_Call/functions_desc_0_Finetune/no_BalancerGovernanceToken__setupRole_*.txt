Type of vulnerability: Access Control Bypass
Cause of vulnerability: Internal functionality of the ERC20PegToken contract allows the dynamic creation and granting of the PAUSER role without proper initialization or validation, leading to unauthorized access to critical functions.
Working process of the code: When a role such as the PAUSER role is added to the contract through the ERC20PegTokenFactory, the _setupRole function is triggered. This function calls the _grantRole function, which, in turn, updates the _role data structure without confirming the validity or initialization of the role. As a result, the role count increases, and the new role is considered granted without the necessary checks and initializations, leading to unauthorized manipulation of the contract.