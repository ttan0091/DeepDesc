Type of vulnerability: Reentrancy
Cause of vulnerability: The contract allows multiple withdrawals by not updating the balance after the first withdrawal, enabling a reentrant call to the `withdraw()` function.
Working process: An investor can initially deposit tokens, then purchase additional tokens, and finally withdraw the total token balance. If the token price decreases in such a way that the balance after the withdrawal is less than the initially deposited amount, a second withdrawal can be made for the remaining balance.