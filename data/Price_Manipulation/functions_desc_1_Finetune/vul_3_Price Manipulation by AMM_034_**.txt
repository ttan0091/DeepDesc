Type of contract: Internal Helper Contract
Purpose: To provide functionality for accessing and interacting with Uniswap v3 liquidity pool tokens.
Working process: The UniswapV3StakeRouter contract serves as an entry point for interfacing with the CanaryStrategyUniswapV3 strategy. It routes user interactions to various internal functions, including getActualValue() which calculates the total value of funds managed by the strategy. This value is determined by the market value of the LP tokens in the strategy pool.
The minTvl config parameter sets a lower threshold for the total value of the strategy (TVS) and is used to trigger a levy action if the actual TVS drops below this threshold. If the TVS is less than minTvl, the strategy will begin to levy the fee on vault deposits (increasing the withdrawable value). The levy size is determined by percentTrickle and percentStrategyFee, with the strategy using all accrued levy fees with each vault deposit or withdraw.
The TVS calculation (getActualValue()) involves accessing the total liquidity in USDC of the strategy Uniswap V3 PMM. This is done by interacting with the UniswapStakeRouterV3.getLpTokenPriceUsdc() function, which calculates the price of LP tokens held by strategy in USDC, allowing the total value of LP tokens in USDC to be calculated.