Type of the contract: ProfitTakerV3.sol
Type of vulnerability: Incorrect Token Values in Custom Token Environment
Cause of vulnerability: Incorrect handling of token price calculation in the profit calculation function, causing secondary token values to be inflated/deflated.
Working of the contract: The contract calculates profits based on the Total Value Locked (TVL) which includes the ETH, HUNNY, and a custom token value. The vulnerability lies in the calculation of the secondary token values (ETH and HUNNY) as they are based on TVL and the project token instead of directly querying onchain values. This can lead to imbalanced profits and allowing flashloaner to drain the liquidity pool by manipulating the project token price.