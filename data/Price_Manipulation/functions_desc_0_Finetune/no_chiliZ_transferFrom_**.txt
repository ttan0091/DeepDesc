Type of vulnerability: Approval Reuse Attack
Cause of vulnerability: The transferFrom function allows the spender to transfer tokens directly from the owner's account to another account while keeping the same approved spenders list.
Exploit scenario: A spender can exploit this by transferring a small amount of tokens from the owner's account to another account using the transferFrom function. This reduces the owner's balance but keeps the spender's approved balance unchanged, enabling multiple transfers using the same approval limit.
Affected version: ERC20 approval system prior to EIP2612, which includes the ERC20 standard and initial implementation of the Semux PegGenesis coin.
Fix: Use the EIP2612 extension to the ERC20 standard, which introduces permit and permitERC20 functions allowing token approvals for a single transaction, thereby preventing the approval reuse attack.