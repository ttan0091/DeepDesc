Type of the contract: ERC20 implementation with additional features
Type of the vulnerability: Improper implementation of the permit function, specifically the addition of the domain separator during signature generation, which is intended only for EIP3009/EIP3074 permits but is also applied to legacy permits leading to incorrect signature verification
Cause of the vulnerability: The legacy permit implementation incorrectly includes the domain separator, which is intended only for the EIP3009 and EIP3074 permit standards, causing the signature verification to fail for legacy permits.
Potential impact of the vulnerability: The vulnerability prevents users from using the permit function to approve spending on their behalf, which can hinder the functionality of integrations that rely on this feature. Additionally, the failed attempts of applications to call permit as part of their operations can result in a transaction being "stuck" if these functions are critical for the application's flow.