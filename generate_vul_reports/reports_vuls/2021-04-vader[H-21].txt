[H-21] Anyone Can Avoid All Vether Transfer Fees By Adding Their Address to the VetherExcludedAddressesList.
Vether.solimplements a fee on every token transfer, unless either the sender or the recipient exists on a list of excluded addresses(mapAddress_Excluded). However, theaddExcluded()function inVether.solhas no restrictions on who can call it.
So any user can calladdExcludedwith their own address as the argument, and bypass all transfer fees.
Alice calls:
(1)Vether.addExcluded(aliceAddress), which adds Aliceâ€™s address tomapAddress_Excluded.
(2) Alice can now freely transfer Vether with no fees.
Recommend adding restrictions to who can calladdExcluded, perhaps by restricting it to a caller set byDAO.sol
strictly-scarce (vader) commented:
Vether contract is outside of contest
dmvt (judge) commented:
https://github.com/code-423n4/2021-04-vader-findings/issues/3#issuecomment-849043144The warden should be paid out on this issue, in my opinion, because the code was included in the repo to be reviewed. The work to review the contract was done despite the fact that the team has addressed the issue and has already deployedvether.sol. I do not think that any issues related toVether.solshould be included in the final report generated by @code423n4.It was unclear to me (and obviously most of the wardens) thatVether.solwas considered out of scope.
moneylegobatman (C4 Editor) commented:
Leaving report and discussion in for transparency, since finding was awarded.