Type of vulnerability: Incorrect Data Offset Reading
Cause of vulnerability: The function `anyFallback()` in the `BranchBridgeAgent` contract incorrectly reads the offset from the received data parameter to get the `depositNonce`, leading to the setting of the status of the wrong deposit to "Failed".
Execution process: The vulnerability occurs when the `anyFallback()` function is called with encoded data that includes a `depositNonce`. Depending on the flag, the function reads the `depositNonce` from an incorrect offset, causing the wrong deposit to be marked as "Failed".
Vulnerable code: The vulnerable code segments are within the `anyFallback()` function where the `depositNonce` is read from the data parameter. Specifically, for flags `0x04`, `0x05`, and `0x06`, the offsets used to read the `depositNonce` are incorrect, as detailed in the vulnerability report.