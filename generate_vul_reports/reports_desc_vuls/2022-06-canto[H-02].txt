Type of vulnerability: Authorization Bypass
Cause of vulnerability: The `approve(address owner, address spender)` function allows an attacker to approve themselves to spend another userâ€™s tokens without proper authorization.
Execution process: An attacker can call the `approve(address owner, address spender)` function, setting the `owner` to another user's address and the `spender` to their own address. Subsequently, the attacker can use the `transferFrom(address src, address dst, uint wad)` function to transfer tokens from the victim's address to their own address.
Vulnerable code: `approve(address owner, address spender) external function` in the WETH.sol contract.