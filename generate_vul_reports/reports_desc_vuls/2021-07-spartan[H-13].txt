Type of vulnerability: Flash loan manipulation
Cause of vulnerability: The calculation of a user’s pool share weight is based on the number of SPARTAN tokens in the pool, which can be manipulated through flash loans.
Execution process: An attacker swaps a large number of WBNB to SPARTAN to increase the pool’s baseAmount, then deposits LP tokens to the pool, artificially increasing their weight in the DaoVault. This allows the attacker to gain more votes or rewards, after which they swap SPARTAN back to WBNB.
Vulnerable code: Utils.sol#L46-L50, Utils.sol#L70-L77, DaoVault.sol#L44-L56, Dao.sol#L201, and Dao.sol#L570.