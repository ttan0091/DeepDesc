Type of vulnerability: Reentrancy and Incorrect TVL Calculation
Cause of vulnerability: The contract does not update the Total Value Locked (TVL) before processing deposits and withdrawals, leading to an outdated TVL calculation.
Execution process: An attacker deposits tokens without updating the TVL, receives LP tokens based on the outdated TVL, updates the TVL to include accrued interest, and then withdraws LP tokens, receiving a larger share of the updated TVL, including the accrued interest.
Vulnerable code: The code snippet where the TVL is not updated before processing deposits and withdrawals, specifically in the `deposit` and `withdraw` functions.