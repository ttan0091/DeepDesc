Type of vulnerability: Era Wipeout Vulnerability
Cause of vulnerability: The contract triggers a new era based on staking or drafting rates crossing a threshold, which can lead to significant holdings in the previous era being wiped out due to a small subsequent seizure.
Execution process: A seizure increases the staking/drafting rate close to a threshold. Subsequent staking or drafting activities increase the total holdings significantly. Another small seizure then crosses the threshold, triggering a new era and wiping out all holdings in the previous era.
Vulnerable code: The vulnerable code involves the logic that checks if the staking or drafting rates cross a threshold and subsequently triggers a new era, wiping out the current era's holdings. Specific lines referenced are:
- https://github.com/reserve-protocol/protocol/blob/c4ec2473bbcb4831d62af55d275368e73e16b984/contracts/p1/StRSR.sol#L441-L444
- https://github.com/reserve-protocol/protocol/blob/c4ec2473bbcb4831d62af55d275368e73e16b984/contracts/p1/StRSR.sol#L457-L460