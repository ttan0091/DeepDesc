Type of vulnerability: Slippage Protection Miscomputation
Cause of vulnerability: Incorrect calculation of slippage protection during token-to-token trades
Execution process: The slippage protection for the second trade (base to token) is incorrectly computed by comparing the input amount of the first trade with the base reserve of the second pair, leading to either unnecessary trade cancellations or acceptance of trades with excessive slippage.
Vulnerable code: `require(iUTILS(UTILS()).calcSwapSlip(inputAmount, // should use outToken here from prev trade iPOOLS(POOLS).getBaseAmount(outputToken)) <= slipLimit);`