Type of vulnerability: Price Manipulation / Reward Gaming
Cause of vulnerability: The spot price used for calculating user weights in the `SynthVault._deposit` function can be manipulated due to its dependence on the current market conditions of the deposit synth amount in BASE.
Execution process: An attacker manipulates the spot price of the iSYNTH(_synth).LayerONE() pool by repeatedly dripping a large amount of BASE into it, which increases the BASE per token price. The attacker then deposits a small amount of synth token, causing the `iUTILS(_DAO().UTILS()).calcSpotValueInBase(iSYNTH(_synth).LayerONE(), _amount)` to return an inflated weight due to the manipulated price. This process can be repeated to further inflate the user's weight, allowing them to claim a disproportionately large share of the rewards.
Vulnerable code: The vulnerable part of the code involves the calculation of the spot value in BASE and the subsequent addition of weight for the user based on this manipulated spot price in the `SynthVault._deposit` function.