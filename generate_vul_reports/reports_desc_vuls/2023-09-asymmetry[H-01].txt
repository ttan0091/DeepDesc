Type of vulnerability: Arbitrage Opportunity
Cause of vulnerability: Price discrepancy between Chainlink oracle prices and actual market prices, combined with mismatched deposit and withdrawal ratios.
Execution process: A user deposits ETH into the contract, which is split and converted into safEth and vAfEth based on an estimated price. Due to the price discrepancy, the user can then withdraw more ETH than initially deposited, exploiting the difference between the estimated and actual prices.
Vulnerable code: The vulnerability arises from the use of `VotiumStrategy.price()` and `ISafEth.approxPrice()` which are based on Chainlink oracles with a 2% deviation threshold, and the mismatch between the deposit ratio and the withdrawal ratio. The specific code sections involved in the deposit and withdrawal processes, where the prices are used to determine the value of safEth and vAfEth, are vulnerable.