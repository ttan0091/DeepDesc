Type of vulnerability: Economic/Miner Extractable Value (MEV)
Cause of vulnerability: Arbitrary manipulation of `tx.gasprice` by miners to inflate the `tokensToDistribute` value.
Execution process: A miner or a user cooperating with a miner manipulates `tx.gasprice` to artificially increase the value of `tokensToDistribute` in the calculation `uint tokensToDistribute = (estimatedGasForPurchase * tx.gasprice) * (125 * 10 ** 18) / 100 / udtPrice`. This can lead to minting a large number of tokens, up to half of the total supply of UDT, which can then be sold on the open market for profit.
Vulnerable code: `uint tokensToDistribute = (estimatedGasForPurchase * tx.gasprice) * (125 * 10 ** 18) / 100 / udtPrice;`