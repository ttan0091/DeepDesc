Type of vulnerability: Insufficient Liquidity Check
Cause of vulnerability: The controller contract does not revert a transaction when there is insufficient liquidity in the controller or strategies during a withdrawal.
Execution process: An attacker deposits an alternate token into the vault, withdraws all available liquidity in the form of the target token, and then allows a victim's transaction to execute, resulting in the victim receiving no tokens while burning shares. The attacker then withdraws the liquidity, profiting from the increased share price.
Vulnerable code: Controller.sol#L577-L622