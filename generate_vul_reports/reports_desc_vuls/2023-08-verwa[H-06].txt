Type of vulnerability: Inadequate Delegation Constraints
Cause of vulnerability: The contract requires users to delegate only to others or themselves with longer lock times, and any changes increase lock times by 5 years, which can force users to remain delegated to someone they do not wish to be or extend their lock much longer than they wish.
Execution process: A user (Bob) delegates to another user (Dave) who started their lock in a different epoch. After some time, Bob wishes to undelegate back to himself but cannot do so without extending his lock by at least 5 years, which he may not want to do.
Vulnerable code: `require(toLocked.end>=fromLocked.end,"Only delegate to longer lock");` in VotingEscrow#L384