Type of vulnerability: Reentrancy
Cause of vulnerability: Reentrancy possibility in `NameWrapper._transferAndBurnFuses` allows execution of external code during token transfer before new owner and fuses are set.
Execution process: An attacker registers and wraps a domain, sets a subdomain owner, creates a contract that unwraps the domain in `onERC1155Received`, and then sets the contract as the new owner. The contract unwraps the domain, but due to reentrancy, the NameWrapper sets fuses and ownership to the contract. The attacker then retrieves the ERC1155 token from the contract.
Vulnerable code: `NameWrapper.sol#L820-L821`, `NameWrapper.sol#L524`, `NameWrapper.sol#L572`