Type of vulnerability: Price Manipulation
Cause of vulnerability: The contract calculates the average price by counting each trade equally, regardless of the trade amount.
Execution process: A malicious agent creates multiple orders with near-zero amounts but at an arbitrary price, pairs these orders with another account, and executes them. This skews the average price calculation towards the arbitrary price set by the agent, affecting funding rates and fair price calculations.
Vulnerable code: `hourlyTracerPrices[currentHour]` calculation that sums trades by counting each trade as 1 instead of summing the `fillAmount`.