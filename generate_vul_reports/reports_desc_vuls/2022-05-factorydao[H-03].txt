Type of vulnerability: Unchecked ERC20 Transfer Return Value
Cause of vulnerability: The `withdraw` function in the MerkleVesting contract does not verify the success of the ERC20 token transfer, leading to potential loss of user funds if the transfer fails.
Execution process: When a user calls the `withdraw` function, the contract updates all relevant state variables and then attempts to transfer tokens to the user using `IERC20(tree.tokenAddress).transfer(destination, currentWithdrawal)`. If the transfer fails (e.g., due to a temporary issue with the ERC20 token contract), the contract does not detect this failure because it does not check the return value of the transfer function. As a result, the function completes execution as if the transfer was successful, leaving the user's funds locked and unrecoverable.
Vulnerable code: `IERC20(tree.tokenAddress).transfer(destination, currentWithdrawal)`