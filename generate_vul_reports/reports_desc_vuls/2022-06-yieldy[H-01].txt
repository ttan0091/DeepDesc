Type of vulnerability: Inability to Withdraw Funds
Cause of vulnerability: The `withdraw` function in the ETH Tokemak pool includes an additional parameter `asEth`, which is not present in other pools like the USDC pool. This discrepancy prevents the withdrawal of ETH/WETH when this parameter is not correctly handled.
Execution process: Users deposit ETH/WETH into the staking contract. When they attempt to withdraw their staked tokens, the presence of the `asEth` parameter in the ETH Tokemak pool's `withdraw` function causes the withdrawal to fail, locking the funds in the contract.
Vulnerable code: The specific code in the ETH Tokemak pool's `withdraw` function that includes the `asEth` parameter, which differs from the `withdraw` function in other pools like the USDC pool, is the source of the vulnerability. The exact code snippet is not provided in the report, but it involves a function signature that includes `asEth` where it should be handled differently for ETH/WETH.