Type of vulnerability: Auction Manipulation
Cause of vulnerability: Lack of validation to prevent NFT owners from creating multiple auctions for the same NFT.
Execution process: An NFT owner (Alice) creates the first auction (Auction id 1) and then quickly creates a second auction (Auction id 2) before any bids are placed. The second auction becomes the active auction, and bidders unknowingly bid on it. Alice then cancels both auctions, locking the funds of the last bidder on the second auction in escrow.
Vulnerable code: NFTMarketReserveAuction.sol#L325-L349 and NFTMarketReserveAuction.sol#L596-L599