
        You are a smart contract development expert.
        Please explain the working process of the following code in detail, as thoroughly as possible. 
        For example, you need to do the following:
        The code I am giving you:
        function sumTokensInPeg(
            ...
        ) internal returns (uint256 totalPeg) {
            ...
        }
        You need to answer like this：
        This code defines an internal function named `sumTokensInPeg`, which ...
        Here’s a detailed explanation of how this function works:
        ...

        [Code you need to process:]
    